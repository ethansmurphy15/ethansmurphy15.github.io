<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Program 5</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"></script>

<style>
body{font-family:Arial;margin:20px;}
.btn{margin:5px;}
table{border-collapse:collapse;margin-top:15px;}
th,td{border:1px solid black;padding:5px;text-align:center;}
th{background:#eee;}
</style>
</head>

<body>

<h2>Select a Major</h2>

<div>
<button class="btn" onclick="getData('CIT')">CIT Majors</button>
<button class="btn" onclick="getData('BUS')">Business Majors</button>
</div>

<h3>We filter our dataset by major</h3>

<div id="studentTable"></div>

</body>

<script type="text/x-handlebars-template" id="studentTemplate">
<table>
<tr><th>Name</th><th>Major</th><th>Midterm</th><th>Final</th></tr>
{{#each rows}}
<tr>
<td>{{name}}</td><td>{{major}}</td><td>{{midterm}}</td><td>{{final}}</td>
</tr>
{{/each}}
</table>
</script>

<script>
async function getData(m){
  let r = await fetch("cit5students.json");
  if(r.ok){
    let d = await r.json();
    let list = d.filter(x => x.major == m);
    let t = document.getElementById("studentTemplate").innerHTML;
    let c = Handlebars.compile(t);
    document.getElementById("studentTable").innerHTML = c({rows:list});
  } else {
    document.getElementById("studentTable").innerHTML = "Error loading data";
  }
}
</script>

</html>

